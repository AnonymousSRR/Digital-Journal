{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h1>{{ page_title }}</h1>
    
    <div class="mb-3">
        <a href="{% url 'my_journals' %}" class="btn btn-secondary">Back to Journals</a>
    </div>
    
    <div class="card mb-4">
        <div class="card-header">
            <h3>{{ entry.title }}</h3>
        </div>
        <div class="card-body">
            <p><strong>Current Version:</strong> {{ entry.version_count }}</p>
            <p><strong>Total Versions:</strong> {{ versions|length }}</p>
        </div>
    </div>
    
    <h2>Version History</h2>
    
    {% if versions %}
    <div class="list-group">
        {% for version in versions %}
        <div class="list-group-item">
            <div class="d-flex w-100 justify-content-between">
                <h5 class="mb-1">Version {{ version.version_number }}
                    {% if version.is_current %}
                        <span class="badge bg-primary">Current</span>
                    {% endif %}
                </h5>
                <small>{{ version.created_at|date:"M d, Y H:i" }}</small>
            </div>
            <p class="mb-1">{{ version.change_summary }}</p>
            <small>Created by: {{ version.created_by.email }}</small>
            <div class="mt-2">
                <a href="{% url 'authentication:view_version' entry.id version.version_number %}" class="btn btn-sm btn-info">View</a>
                <a href="{% url 'authentication:export_version_pdf' entry.id version.version_number %}" class="btn btn-sm btn-success">Export PDF</a>
                {% if not version.is_current %}
                <a href="{% url 'authentication:restore_version' entry.id version.version_number %}" class="btn btn-sm btn-warning">Restore</a>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>No versions found.</p>
    {% endif %}
</div>
{% endblock %}
